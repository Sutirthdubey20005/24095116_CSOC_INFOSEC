# ğŸ›¡ï¸ CSOC InfoSec Forensics - Week 1, Day 7, Task 13: Proxy Log Analysis

This writeup covers the solutions for **CSOC InfoSec Forensics Week 1, Day 7, Task 13**, focusing on basic Linux command-line skills for analyzing proxy logs. The goal is to extract key information and identify suspicious activity using commands like `cut`, `grep`, `sort`, and `uniq`.

## WALKTHROUGH

Here are the questions, the commands used, and the answers, assuming `access.log` is the log file.

### Q#1: How many unique IP addresses are connected to the proxy server?

ğŸ¯ **Goal:** Count unique client IPs.

* **Command:**
    ```bash
    cut -d ' ' -f2 access.log | sort -u | wc -l
    ```
* **Answer:** `9`

---

### Q#2: How many unique domains were accessed by all workstations?

ğŸ¯ **Goal:** Count unique domains visited.

* **Command:**
    ```bash
    cut -d ' ' -f3 access.log | cut -d ':' -f1 | sort -u | wc -l
    ```
* **Answer:** `111`

---

### Q#3: What status code is generated by the HTTP requests to the least accessed domain?

ğŸ¯ **Goal:** Find the status code for the domain with the fewest requests.

* **Command:**
    ```bash
    cut -d ' ' -f3,6 access.log | sort | uniq -c | sort -n | head -n 1
    ```
* **Answer:** `503`

---

### Q#4: Based on the high count of connection attempts, what is the name of the suspicious domain?

ğŸ¯ **Goal:** Identify the most frequently accessed domain.

* **Command:**
    ```bash
    cut -d ' ' -f3 access.log | sort | uniq -c | sort -nr
    ```
* **Answer:** `frostlings.bigbadstash.thm`

---

### Q#5: What is the source IP of the workstation that accessed the malicious domain?

ğŸ¯ **Goal:** Find the IP that accessed `frostlings.bigbadstash.thm`.

* **Command:**
    ```bash
    grep "frostlings.bigbadstash.thm" access.log | cut -d ' ' -f2 | sort | uniq
    ```
* **Answer:** `10.10.185.225`

---

### Q#6: How many requests were made on the malicious domain in total?

ğŸ¯ **Goal:** Count total requests to `frostlings.bigbadstash.thm`.

* **Command:**
    ```bash
    grep frostlings.bigbadstash.thm access.log | wc -l
    ```
* **Answer:** `1581`

---

### Q#7: Having retrieved the exfiltrated data, what is the hidden flag?

ğŸ¯ **Goal:** Extract and decode the hidden flag from malicious domain requests.

* **Command:**
    ```bash
    grep "frostlings.bigbadstash.thm" access.log | cut -d ' ' -f5 | cut -d '=' -f2 | base64 -d
    ```
* **Answer:** `THM{a_gift_for_you_awesome_analyst!}`

---

These commands demonstrate fundamental log analysis techniques using common Linux tools.
